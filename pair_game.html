<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pairgame</title>
    <style>
        :root {
            /* ç²‰ç´«è‰²ç³»è¨­å®š */
            --primary-color: #AB47BC;  /* æŒ‰éˆ•æ–‡å­—/ä¸»è¦è‰² */
            --active-text: #4A148C;    /* é¸ä¸­æ™‚çš„æ–‡å­—è‰² */
            --card-back: #CE93D8;      /* å¡èƒŒé¡è‰² (ç´ è‰²) */
            --card-front: #FFFFFF;     /* å¡é¢é¡è‰² */
            --success-color: #8E24AA;  /* é…å°æˆåŠŸæ¡†ç·š */
            --grey-text: #9E9E9E;      /* ç°è‰²æ–‡å­— */
            --bg-control: #F3F3F3;     /* æŒ‰éˆ•æ§åˆ¶å€åº•è‰² */
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #FFFFFF; /* ç§»é™¤èƒŒæ™¯åº•è‰²ï¼Œæ”¹ç‚ºç™½ */
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* æ¨™é¡Œèˆ‡æ§åˆ¶å€ */
        header {
            width: 100%;
            padding: 20px 15px 10px 15px; /* å¢åŠ ä¸€é»ä¸Šæ–¹ç•™ç™½ */
            text-align: center;
            background-color: #fff;
            /* ç§»é™¤ header é™°å½±è®“ç•«é¢æ›´ä¹¾æ·¨ */
        }

        h1 {
            /* åŸæœ¬ 1.2rem -> åŠ å¤§ */
            font-size: 24px; 
            margin: 0 0 15px 0;
            letter-spacing: 1px;
            color: var(--active-text);
        }

        /* ä¿®æ”¹å¾Œçš„æŒ‰éˆ•å®¹å™¨ - æ¨¡æ“¬ iOS Segmented Control èƒŒæ™¯ */
        .controls {
            display: flex;
            justify-content: center;
            background-color: var(--bg-control);
            padding: 4px;
            border-radius: 10px;
            margin: 0 auto 15px auto;
            max-width: 320px; /* æ§åˆ¶æŒ‰éˆ•å€æœ€å¤§å¯¬åº¦ */
        }

        /* æ‚¨æä¾›çš„æŒ‰éˆ•æ¨£å¼ */
        .mode-btn {
            flex: 1;
            border: none;
            background: transparent;
            padding: 8px 0;
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--grey-text); /* æœªé¸ä¸­æ™‚ç‚ºç°è‰² */
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mode-btn.active {
            background: white;
            color: var(--active-text); /* é¸ä¸­æ™‚ç‚ºæ·±ç´«è‰² */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        /* ç‹€æ…‹åˆ—èª¿æ•´ */
        .status-bar {
            font-size: 0.9rem;
            margin-bottom: 15px;
            display: flex;
            justify-content: center; /* ç½®ä¸­å°é½Š */
            gap: 25px;
            color: var(--grey-text); /* æ–‡å­—æ”¹ç‚ºç°è‰² */
        }

        /* éŠæˆ²å€åŸŸå®¹å™¨ */
        #game-container {
            width: 92%; /* ç¨å¾®ç¸®å°å¯¬åº¦æ¯”ä¾‹ */
            max-width: 480px; /* æœ€å¤§å¯¬åº¦ç¸®å°ï¼Œè®“å¡ç‰‡è®Šå° */
            margin: 0 auto;
            display: grid;
            gap: 6px; /* é–“è·ç¸®å° 2px (åŸ8px) */
            padding-bottom: 30px;
            perspective: 1000px;
        }

        /* å¡ç‰‡æ¨£å¼ */
        .card {
            background-color: transparent;
            aspect-ratio: 1 / 1;
            cursor: pointer;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.4s;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 6px; /* åœ“è§’éš¨å¡ç‰‡ç¸®å°ç¨å¾®èª¿æ•´ */
            display: flex;
            justify-content: center;
            align-items: center;
            backface-visibility: hidden;
        }

        /* å¡èƒŒ (æœªç¿»é–‹) - ç§»é™¤åœ–æ¡ˆï¼Œæ”¹ç‚ºç´ è‰² */
        .front {
            background-color: var(--card-back);
            transform: rotateY(0deg);
        }
        
        /* ç§»é™¤åŸæœ¬çš„ .front::after (åœ“åœˆè£é£¾) */

        /* å¡é¢ (åœ–æ¡ˆé¢) */
        .back {
            background-color: var(--card-front);
            transform: rotateY(180deg);
            border: 1px solid #eee; /* å¢åŠ æ¥µæ·¡é‚Šæ¡†å¢åŠ å±¤æ¬¡ */
        }

        .card.matched .back {
            border-color: var(--success-color);
            background-color: #F8F1FA;
        }

        /* SVG åœ–å½¢æ¨£å¼ - ç¨å¾®ç¸®å°è®“ç•™ç™½æ›´å¤š */
        .shape-svg {
            width: 55%; 
            height: 55%;
        }

        /* å‹åˆ©å½ˆçª— */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); /* èƒŒæ™¯æ›´ç™½ä¸€é» */
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 100;
        }
        
        .modal.show {
            display: flex;
            animation: fadeIn 0.3s;
        }

        .modal h2 {
            color: var(--active-text);
            margin-bottom: 10px;
        }
        
        .modal p {
            color: var(--grey-text);
            margin-bottom: 25px;
        }

        .restart-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(171, 71, 188, 0.3);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

    </style>
</head>
<body>

<header>
    <h1>Pairgame</h1>
    <div class="controls">
        <button onclick="startGame('easy')" class="mode-btn" id="btn-easy">ç°¡å–®</button>
        <button onclick="startGame('medium')" class="mode-btn" id="btn-medium">ä¸­ç­‰</button>
        <button onclick="startGame('hard')" class="mode-btn" id="btn-hard">å›°é›£</button>
    </div>
    <div class="status-bar">
        <span id="moves">æ­¥æ•¸: 0</span>
        <span id="pairs">é…å°: 0</span>
    </div>
</header>

<div id="game-container">
    </div>

<div id="victory-modal" class="modal">
    <h2>ğŸ‰ å®ŒæˆéŠæˆ²ï¼</h2>
    <p id="final-score">ç¸½æ­¥æ•¸: 0</p>
    <button class="restart-btn" onclick="restartCurrentLevel()">å†ç©ä¸€æ¬¡</button>
</div>

<script>
    // éŠæˆ²è¨­å®š
    const config = {
        easy: { rows: 5, cols: 4 },
        medium: { rows: 6, cols: 5 },
        hard: { rows: 7, cols: 6 }
    };

    // åœ–å½¢èˆ‡é¡è‰²æ± 
    const shapes = ['circle', 'rect', 'triangle', 'diamond', 'cross', 'star', 'hexagon'];
    const colors = ['#BA68C8', '#EF5350', '#42A5F5', '#66BB6A', '#FFA726', '#FF7043', '#8D6E63', '#78909C'];

    let currentLevel = 'easy';
    let cards = [];
    let flippedCards = [];
    let matchedPairs = 0;
    let moves = 0;
    let isLocked = false;

    const gameContainer = document.getElementById('game-container');
    const moveDisplay = document.getElementById('moves');
    const pairDisplay = document.getElementById('pairs');
    const modal = document.getElementById('victory-modal');

    function generateCardContent(totalPairs) {
        let deck = [];
        let shapeIndex = 0;
        let colorIndex = 0;

        for (let i = 0; i < totalPairs; i++) {
            const shape = shapes[shapeIndex % shapes.length];
            const color = colors[colorIndex % colors.length];
            
            shapeIndex++;
            if (shapeIndex % shapes.length === 0) colorIndex++;

            const cardData = { shape, color, id: i };
            deck.push(cardData, cardData);
        }

        for (let i = deck.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [deck[i], deck[j]] = [deck[j], deck[i]];
        }
        return deck;
    }

    function getSvgIcon(type, color) {
        let path = '';
        switch(type) {
            case 'circle': path = '<circle cx="50" cy="50" r="40" />'; break;
            case 'rect': path = '<rect x="15" y="15" width="70" height="70" rx="10" />'; break;
            case 'triangle': path = '<polygon points="50,15 90,85 10,85" />'; break;
            case 'diamond': path = '<polygon points="50,10 90,50 50,90 10,50" />'; break;
            case 'cross': path = '<path d="M20,20 L80,80 M80,20 L20,80" stroke-width="15" stroke-linecap="round" />'; break;
            case 'star': path = '<polygon points="50,10 61,35 90,35 66,55 75,85 50,65 25,85 34,55 10,35 39,35" />'; break;
            case 'hexagon': path = '<polygon points="50,10 85,30 85,70 50,90 15,70 15,30" />'; break;
        }
        const attr = type === 'cross' ? `stroke="${color}" fill="none"` : `fill="${color}"`;
        return `<svg viewBox="0 0 100 100" class="shape-svg" ${attr}>${path}</svg>`;
    }

    function startGame(level) {
        currentLevel = level;
        
        // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`btn-${level}`).classList.add('active');

        // é‡ç½®æ•¸æ“š
        matchedPairs = 0;
        moves = 0;
        flippedCards = [];
        isLocked = false;
        moveDisplay.textContent = `æ­¥æ•¸: ${moves}`;
        pairDisplay.textContent = `é…å°: ${matchedPairs}`;
        modal.classList.remove('show');

        // è¨­å®š Grid
        const rows = config[level].rows;
        const cols = config[level].cols;
        gameContainer.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

        // ç”Ÿæˆå¡ç‰‡
        const totalCards = rows * cols;
        const deckData = generateCardContent(totalCards / 2);
        gameContainer.innerHTML = '';
        
        deckData.forEach((data, index) => {
            const card = document.createElement('div');
            card.classList.add('card');
            card.dataset.id = data.id;
            
            const front = document.createElement('div');
            front.classList.add('card-face', 'front');

            const back = document.createElement('div');
            back.classList.add('card-face', 'back');
            back.innerHTML = getSvgIcon(data.shape, data.color);

            card.appendChild(front);
            card.appendChild(back);
            
            card.addEventListener('click', () => flipCard(card));
            gameContainer.appendChild(card);
        });
    }

    function flipCard(card) {
        if (isLocked) return;
        if (card.classList.contains('flipped')) return;

        card.classList.add('flipped');
        flippedCards.push(card);

        if (flippedCards.length === 2) {
            moves++;
            moveDisplay.textContent = `æ­¥æ•¸: ${moves}`;
            checkForMatch();
        }
    }

    function checkForMatch() {
        isLocked = true;
        const [card1, card2] = flippedCards;
        
        if (card1.dataset.id === card2.dataset.id) {
            disableCards();
        } else {
            unflipCards();
        }
    }

    function disableCards() {
        flippedCards.forEach(card => card.classList.add('matched'));
        matchedPairs++;
        pairDisplay.textContent = `é…å°: ${matchedPairs}`;
        flippedCards = [];
        isLocked = false;

        const totalPairs = (config[currentLevel].rows * config[currentLevel].cols) / 2;
        if (matchedPairs === totalPairs) {
            setTimeout(() => {
                document.getElementById('final-score').textContent = `ç¸½æ­¥æ•¸: ${moves}`;
                modal.classList.add('show');
            }, 500);
        }
    }

    function unflipCards() {
        setTimeout(() => {
            flippedCards.forEach(card => card.classList.remove('flipped'));
            flippedCards = [];
            isLocked = false;
        }, 800);
    }

    function restartCurrentLevel() {
        startGame(currentLevel);
    }

    // åˆå§‹åŒ–
    startGame('easy');

</script>
</body>
</html>